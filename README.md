# README

## 项目简介

这是一个基于LangGraph和Ollama的图像分析工作流。用户可以输入需求，系统会根据需求进行图像分类、标注或描述任务。工作流通过不同的节点处理图像，来完成需求分析与图像处理。

### 支持的功能：

- **分类（Classification）**: 根据图像识别主要的物体或类别。
- **标注（Annotation）**: 检测并标记图像中的多个对象和它们的位置。
- **描述（Interpretation）**: 提供图像的详细描述。

## 项目结构

- `ImageState`: 定义图像处理和状态信息的对象。
- `analysis_node`: 解析用户需求并确定任务类型（分类、标注或描述）。
- `image_input_node`: 输入图像文件路径。
- `preprocess_node`: 根据任务对图像进行预处理。
- `model_selection_node`: 根据任务选择合适的模型。
- `inference_node`: 使用选择的模型进行推理。
- `output_node`: 输出推理结果，分类结果会显示类别，标注结果会生成带标注的图片，描述结果会输出图像的文字描述。

## 安装要求

1. Python 版本：3.13
2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

3. 需要本地运行 **Ollama** 模型，确保在 `http://localhost:11434` 上可以访问 **Ollama** 服务。

4. 确保安装了或网络能够下载 **YOLOv5** 模型和 **ResNet50** 等深度学习模型。

## 使用方法

1. 运行脚本：
   ```bash
   python Test2.py
   ```

2. 系统会提示用户输入需求，如：“识别图片中的动物”或“描述图片内容”等。根据用户的需求，工作流会自动处理图像并输出结果。

3. 工作流会执行以下步骤：
   - **需求分析**：识别用户的需求类型（分类、标注或描述）。
   - **图像输入**：加载图像文件。
   - **图像预处理**：根据任务要求进行图像预处理。
   - **模型选择**：根据任务选择对应的深度学习模型。
   - **推理**：使用选择的模型对图像进行推理。
   - **输出**：输出任务结果，如果是分类，会输出分类结果；如果是标注，会显示标注结果；如果是描述，会提供图像的文字描述。

## 示例

1. **分类任务示例**：
   用户输入：`识别图片中的动物`
   系统输出：`分类结果：dog`

2. **标注任务示例**：
   用户输入：`检测并标注所有物体`
   系统输出：生成带有标注框的图像`annotated_image.jpg`文件，并显示检测到的物体。

3. **描述任务示例**：
   用户输入：`描述图片内容`
   系统输出：`图像描述：这是一只在草地上跑的狗。`

## 注意事项

1. 确保提供的图像文件路径正确，并且是支持的格式（.jpg, .png, .jpeg）。
2. 对于标注任务，输出图像会保存为 `annotated_image.jpg` 文件。
3. 使用描述功能时，图像将会通过 Ollama 模型进行处理，确保本地服务正常运行。